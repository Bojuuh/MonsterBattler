### Security demo - simple checks for auth endpoints
GET {{url}}/auth/test/
Accept: application/json

###
POST {{url}}/auth/register
Content-Type: application/json
Accept: application/json

{
  "username": "demo_user",
  "password": "test123"
}

###
POST {{url}}/auth/login
Content-Type: application/json
Accept: application/json

{
  "username": "demo_user",
  "password": "test123"
}

> {%
    client.global.set("jwt_token", response.body.token);
    console.log("JWT Token:", client.global.get("jwt_token"));
%}

###
# Access protected user demo (should succeed if logged in)
GET {{url}}/protected/user_demo
Accept: application/json
Authorization: Bearer {{jwt_token}}

###
# Access admin demo (should fail unless role ADMIN added)
GET {{url}}/protected/admin_demo
Accept: application/json
Authorization: Bearer {{jwt_token}}

###
# Add admin role to logged-in user (requires authentication)
POST {{url}}/auth/user/addrole
Content-Type: application/json
Accept: application/json
Authorization: Bearer {{jwt_token}}

{
  "role": "admin"
}

###
# Retry admin demo (should succeed if role was added)
GET {{url}}/protected/admin_demo
Accept: application/json
Authorization: Bearer {{jwt_token}}
